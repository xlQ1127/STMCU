/****************************************Copyright (c)*************************
**                               ?? (C), 2015-2020, 娑楦绉
**
**                                 http://www.tuya.com
**
**--------------浠朵俊-------------------------------------------------------
**?   浠?   ?: protocol.h
**?        杩?: 涓/涓ユ版澶芥
**浣? ? 璇? ? :

                  *******甯搁瑕锛涓瀹瑕锛锛锛?********

** 1ㄦ峰ㄦゆ浠朵腑瀹版版涓/涓ュ
** 2DPID/TYPE版澶芥伴介?瑕ㄦ锋у瀹涔瀹?
** 3褰寮?濮浜瀹瀹涔瑕ㄦ峰颁唬芥板ㄦ?#err绀,瀹芥板璇峰よ?#err
**
**--------------褰淇璁---------------------------------------------------
** ?  ?: v1.0.2
** ャ???: 2018骞?12?6?
** ??杩?: 1:澧浣ㄩapiュｆ浠
           2:淇瑰ㄥ板藉煎?
		   
** ?  ?: v1.0.1
** ャ???: 2018骞?11?1?
** ??杩?: 1:浣SDK涓绾挎ｅ?

** ?  ?: v1.0
** ャ???: 2018骞?4?24?
** ??杩?: 1:浣SDK棣锛?1.0.2璁
**
**-----------------------------------------------------------------------------
******************************************************************************/
#ifndef __PROTOCOL_H_
#define __PROTOCOL_H_



/******************************************************************************
                            ㄦ风稿充俊缃
******************************************************************************/

/******************************************************************************
                          缃轰欢寮?                  
濡瑕MCU浠绫诲?,璇峰璇ュ?
MCU璋lock_api.c浠跺浠绫讳ㄦュｅ扮稿冲?
                        ********WARNING!!!**********
ㄩ绫诲榛璁ゆ轰欢绾?,轰欢绾у涓256瀛
濡瑕寮璇ュ,涓插ｆユ剁插轰澶
******************************************************************************/
#define         LOCK_API_ENABLE                         //寮?lock_apiュ
#ifdef LOCK_API_ENABLE
#define         SUPPORT_MCU_FIRM_UPDATE                 //寮?MCU轰欢绾у(绫诲?锛榛璁ゆ)
#endif

/******************************************************************************
                            1:淇逛骇淇℃                
******************************************************************************/
#define PRODUCT_KEY "b7do7sirjb0bfka0"    //开发平台创建产品后生成的16位字符产品唯一标识


#define MCU_VER "1.0.0"                                 //ㄦ风杞浠剁?,ㄤMCU轰欢绾,MCU绾х?淇
/******************************************************************************
                         2:瀹涔跺缂瀛:
                    濡褰浣跨MCURAM涓澶,淇逛负24
******************************************************************************/
#ifndef SUPPORT_MCU_FIRM_UPDATE
#define WIFI_UART_QUEUE_LMT             16              //版ユ堕澶у,濡MCURAM涓澶,缂╁?
#define WIFI_UART_RECV_BUF_LMT          24              //规ㄦDP版澶у瀹,蹇椤诲ぇ浜24
#else
#define WIFI_UART_QUEUE_LMT             128              //版ユ堕澶у,濡MCURAM涓澶,缂╁?
#define WIFI_UART_RECV_BUF_LMT          300              //规ㄦDP版澶у瀹,蹇椤诲ぇ浜24
#endif

#define WIFIR_UART_SEND_BUF_LMT         24              //规ㄦDP版澶у瀹,蹇椤诲ぇ浜24

/******************************************************************************
                      3:MCU?瑕℃跺?                     
濡瑕璇峰?璇ュ?,骞跺Protocol.c浠跺mcu_write_rtctime瀹颁唬
mcu_write_rtctimeㄦ?#err绀,瀹芥板璇峰よ?#err
mcuwifi妯″姝ｇ‘缃璋mcu_get_system_time()芥板璧锋℃跺
******************************************************************************/
//#define         SUPPORT_MCU_RTC_CHECK                //寮?℃跺?

/******************************************************************************
                      4:MCU?瑕wifi芥璇                     
濡瑕璇峰?璇ュ?,骞朵mcuㄩ瑕wifi芥璇澶璋mcu_api.c浠跺mcu_start_wifitest
骞跺protocol.c浠wifi_test_result芥板ョ娴璇缁?,
wifi_test_resultㄦ?#err绀,瀹芥板璇峰よ?#err
******************************************************************************/
#define         WIFI_TEST_ENABLE                //寮?WIFI浜ф

/******************************************************************************
                        1:dp版瑰烽板涔
          **姝や负ㄧ浠ｇ,濡ㄥ?骞冲版稿充慨硅烽颁杞MCU_SDK**         
******************************************************************************/
//解锁方式(只上报)
//备注:具体的编号与开门方式的对应，可以在多语言中翻译
1=人脸、2=密码、3=卡、4=机械钥匙 
#define DPID_UNLOCK_TYPE 101
//解锁ID(只上报)
//备注:门锁上报远程开门请求，需要硬件主动触发
门锁本地上报远程开门请求时，携带x秒倒计时，只有在x秒内才能做出响应，点击允许，门锁将会解锁。可以x小于等于90
#define DPID_UNLOCK_ID 102
//报警(只上报)
//备注:1=低电、2=电池即将耗尽、3=防撬报警、4=密码盘锁死、5=假锁、6=高温
#define DPID_ALART 103
//远程开门倒计时(只上报)
//备注:
#define DPID_OPEN_DOOR_TIME 104
//电量状态(只上报)
//备注:高、中、低、超低（即将关机）
#define DPID_BATTERY 105



/*****************************************************************************
芥板绉 : all_data_update
芥杩 : 绯荤?dp逛俊涓浼?
杈ュ : ?
杩 : ?
浣跨ㄨ存 : MCU蹇椤诲拌ュ芥板版涓ュ
*****************************************************************************/
void all_data_update(void);

/*****************************************************************************
芥板绉 : dp_record_combine_update
芥杩 : 璁板版缁涓?
杈ュ : time     : 堕存版?,棣瀛琛ㄧず浼杈蹇浣锛朵渚娆′负骞淬?ャ躲绉
           dp_bool  : booldpid?, v_bool:瀵瑰?
           dp_enum  : enumdpid?, v_enum:瀵瑰?
           dp_value : valuedpid?, v_value:瀵瑰?
           dp_string: stringdpid?, v_string:瀵瑰?,len:string垮害
杩 : ?
*****************************************************************************/
unsigned char dp_record_combine_update(unsigned char time[],
                                       unsigned char dp_bool,unsigned char v_bool,
                                       unsigned char dp_enum,unsigned char v_enum,
                                       unsigned char dp_value,unsigned char v_value,
                                       unsigned char dp_string,unsigned char v_string[],unsigned char len);

#ifdef SUPPORT_MCU_RTC_CHECK
/*****************************************************************************
芥板绉 : mcu_write_rtctime
芥杩 : MCU″规RTC堕
杈ュ : ?
杩 : ?
浣跨ㄨ存 : MCU?瑕琛瀹拌ュ
*****************************************************************************/
void mcu_write_rtctime(unsigned char time[]);
#endif

#ifdef WIFI_TEST_ENABLE
/*****************************************************************************
芥板绉 : wifi_test_result
芥杩 : wifi芥璇棣
杈ュ : result:wifi芥璇缁;0:澶辫触/1:
           rssi:娴璇琛ㄧずwifi淇″峰己搴/娴璇澶辫触琛ㄧず璇绫诲
杩 : ?
浣跨ㄨ存 : MCU?瑕琛瀹拌ュ
*****************************************************************************/
void wifi_test_result(unsigned char result,unsigned char rssi);
#endif

/*****************************************************************************
芥板绉 : wifi_update_handle
芥杩 : MCU璇锋mcu轰欢绾ц芥
杈ュ : status:￠蹇
杩 : ?
浣跨ㄨ存 : MCU涓诲ㄨ wifi_update_request 芥板璇ュ芥板峰绾у舵??
*****************************************************************************/
void wifi_update_handle(unsigned char status);

#ifdef SUPPORT_MCU_FIRM_UPDATE
/*****************************************************************************
芥板绉 : mcu_firm_update_handle
芥杩 : MCU杩ュ轰欢绾фā寮
杈ュ : value:轰欢缂插?
           position:褰版ㄤ轰欢浣缃?
           length:褰轰欢垮?(轰欢垮害涓0?,琛ㄧず轰欢瀹?)
杩 : ?
浣跨ㄨ存 : MCU?瑕琛瀹拌ュ
*****************************************************************************/
unsigned char mcu_firm_update_handle(const unsigned char value[],unsigned long position,unsigned short length);
#endif

/*****************************************************************************
芥板绉 : dp_download_handle
芥杩 : dp涓澶芥
杈ュ : dpid:DP搴
value:dp版缂插哄板?
length:dp版垮害
杩 : 杩:SUCCESS/澶辫触杩:ERRO
浣跨ㄨ存 : 璇ュ芥扮ㄦ蜂戒慨?
*****************************************************************************/
unsigned char dp_download_handle(unsigned char dpid,const unsigned char value[], unsigned short length);
/*****************************************************************************
芥板绉 : get_download_cmd_total
芥杩 : 峰?dp戒护诲
杈ュ : ?
杩 : 涓戒护诲
浣跨ㄨ存 : 璇ュ芥扮ㄦ蜂戒慨?
*****************************************************************************/
unsigned char get_download_cmd_total(void);

#endif

